<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>TV CELL AZUL - MODO DIN√ÇMICO</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        /* =======================================================================
        ‚ö†Ô∏è AVISO DE CONFIGURA√á√ÉO DE TELA (ALTERE AQUI):
        
        SE A TV ESTIVER DEITADA (HORIZONTAL): Deixe o valor 'none' abaixo.
        SE A TV ESTIVER EM P√â (VERTICAL): Mude o valor para 'rotate(90deg)'.
        =======================================================================
        */
        :root {
            --ajuste-rotacao: none; /* <--- ALTERE APENAS ESTA PALAVRA */
        }

        body { 
            margin: 0; 
            background: #000; 
            color: #fff; 
            font-family: sans-serif; 
            height: 100vh; 
            width: 100vw;
            display: flex; 
            flex-direction: column; 
            overflow: hidden;
            /* Aplica a rota√ß√£o escolhida no aviso acima */
            transform: var(--ajuste-rotacao); 
            transform-origin: center;
        }
        
        #main { flex: 1; display: flex; flex-direction: row; }
        
        /* Ajuste autom√°tico para telas verticais modernas */
        @media (max-width: 900px) {
            #main { flex-direction: column; }
            #side { width: 100% !important; border-left: none !important; border-top: 5px solid #FFD700; }
        }

        #promo { flex: 3; display: flex; align-items: center; justify-content: center; background: #111; }
        #banner-img { max-width: 95%; max-height: 95%; object-fit: contain; }

        #side { 
            flex: 1; 
            background: #003399; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: space-around; 
            padding: 20px; 
            border-left: 5px solid #FFD700; 
            text-align: center; 
        }
        
        .qr-area { background: #fff; padding: 10px; border-radius: 15px; width: 60%; max-width: 250px; }
        .qr-area img { width: 100%; display: block; }
        
        .counter { font-size: 6rem; color: #FFD700; font-weight: bold; }

        #win-overlay { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.95); display: none; flex-direction: column; 
            align-items: center; justify-content: center; z-index: 1000; color: #FFD700; 
        }
    </style>
</head>
<body>
    <div id="win-overlay">
        <h1 style="font-size: 4rem;">üéâ TEMOS UM GANHADOR!</h1>
        <h2 id="win-premio" style="font-size: 3rem; color: #fff;">---</h2>
    </div>

    <div id="main">
        <div id="promo"><img id="banner-img" src=""></div>
        <div id="side">
            <h1 style="margin:0;">CELL AZUL</h1>
            <div class="qr-area"><img id="qr-display" src="/qrcode"></div>
            <p>SORTEIO NO QR CODE</p>
            <div>
                <p style="margin:0;">RESTAM APENAS:</p>
                <div id="qtd-display" class="counter">--</div>
            </div>
        </div>
    </div>

    <audio id="vitoria-som" src="vitoria.mp3"></audio>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        const som = document.getElementById('vitoria-som');

        socket.on('trocar_slide', (dados) => {
            document.getElementById('banner-img').src = dados.arquivo;
            document.getElementById('qtd-display').innerText = dados.qtd;
            document.getElementById('qr-display').src = '/qrcode?v=' + Date.now();
        });

        socket.on('atualizar_qtd', (dados) => {
            document.getElementById('qtd-display').innerText = dados.qtd;
        });

        socket.on('aviso_vitoria_tv', (dados) => {
            const overlay = document.getElementById('win-overlay');
            document.getElementById('win-premio').innerText = dados.premio;
            overlay.style.display = 'flex';
            som.play().catch(() => {});
            confetti({ particleCount: 200, spread: 80, origin: { y: 0.6 } });
            setTimeout(() => { overlay.style.display = 'none'; }, 7000);
        });

        // Clique para ativar o som na TV
        document.body.onclick = () => { som.play(); som.pause(); };
    </script>
</body>
</html>
