<!DOCTYPE html>
<html>
<head>
    <title>TV CELL AZUL</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        body { margin: 0; background: black; font-family: 'Montserrat', sans-serif; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
        #main { flex: 1; display: flex; }
        #banner { flex: 3; background: #111; display: flex; align-items: center; justify-content: center; position: relative; }
        #imgPrincipal { max-width: 95%; max-height: 95%; object-fit: contain; z-index: 2; }
        #sidebar { flex: 1; background: #003399; color: white; display: flex; flex-direction: column; align-items: center; justify-content: space-around; padding: 20px; border-left: 5px solid #FFD700; text-align: center; }
        .qr-box { background: white; padding: 15px; border-radius: 20px; width: 80%; }
        .qr-box img { width: 100%; display: block; }
        .counter { font-size: 6rem; color: #FFD700; margin: 0; }
        #footer { height: 10vh; background: #111; border-top: 4px solid #FFD700; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.5rem; text-transform: uppercase; }
        #overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 99; display: none; flex-direction: column; align-items: center; justify-content: center; color: #FFD700; text-align: center; }
    </style>
</head>
<body>
    <div id="overlay">
        <h1 style="font-size: 5rem;">ðŸŽ‰ TEM GANHADOR! ðŸŽ‰</h1>
        <h2 id="winPremio" style="font-size: 3rem; color: white;">---</h2>
    </div>

    <div id="main">
        <div id="banner">
            <img id="imgPrincipal" src="">
        </div>
        <div id="sidebar">
            <h2 id="lojaNome">CELL AZUL</h2>
            <div class="qr-box">
                <img id="qrImg" src="/qrcode">
            </div>
            <p>SORTEIO NO QR CODE</p>
            <div>
                <p>RESTAM APENAS:</p>
                <div id="qtd" class="counter">--</div>
            </div>
        </div>
    </div>
    <div id="footer" id="footerText">CELL AZUL ACESSÃ“RIOS - PROMOÃ‡ÃƒO ESPECIAL</div>

    <audio id="som" src="/vitoria.mp3"></audio>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        const som = document.getElementById('som');

        socket.on('trocar_slide', (d) => {
            document.getElementById('imgPrincipal').src = '/' + d.arquivo;
            document.getElementById('lojaNome').innerText = d.loja;
            document.getElementById('qtd').innerText = d.qtd;
            document.getElementById('qrImg').src = '/qrcode?v=' + Date.now();
        });

        socket.on('atualizar_qtd', (d) => { document.getElementById('qtd').innerText = d.qtd; });

        socket.on('aviso_vitoria_tv', (d) => {
            const ov = document.getElementById('overlay');
            document.getElementById('winPremio').innerText = d.premio;
            ov.style.display = 'flex';
            som.play().catch(() => console.log("Clique na tela para habilitar o som"));
            confetti({ particleCount: 200, spread: 70, origin: { y: 0.6 } });
            setTimeout(() => { ov.style.display = 'none'; }, 7000);
        });

        document.body.onclick = () => { som.play(); som.pause(); };
    </script>
</body>
</html>
